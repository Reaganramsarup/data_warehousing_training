CREATE OR REPLACE PROCEDURE DATA_WAREHOUSE.PUBLIC.LOAD_DIM_CURRENCY()
RETURNS VARCHAR NOT NULL
LANGUAGE SQL
AS

BEGIN
MERGE INTO DATA_WAREHOUSE.PUBLIC.DIM_CURRENCY
USING (
SELECT
CURRENCY_CODE
FROM DATA_WAREHOUSE.PUBLIC.VIRTUAL_DIM_CURRENCY
) AS b ON DIM_CURRENCY.CURRENCY_CODE = b.CURRENCY_CODE
WHEN NOT MATCHED THEN 
  INSERT 
  ( CURRENCY_SK,
    CURRENCY_CODE
  ) 
   VALUES 
   (SEQ_CURRENCY_SK.nextval, 
    b.CURRENCY_CODE);

RETURN 'Load is complete';

END;

