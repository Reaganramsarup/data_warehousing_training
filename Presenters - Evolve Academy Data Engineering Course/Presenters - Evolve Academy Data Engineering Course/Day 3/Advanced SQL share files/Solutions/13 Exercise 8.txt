-- Lets first create a view
CREATE VIEW SUPPORTING_DATA.PUBLIC.CUSTOMER_SPEND
AS 
SELECT 
        CUSTOMER_ID, 
        SUM(ORDER_AMOUNT) AS SPEND_AMOUNT
FROM HOL_DB.RAW_POS.ORDER_HEADER
WHERE CUSTOMER_ID IS NOT NULL
GROUP BY CUSTOMER_ID


--Solution with addition of Dense Rank

SELECT 
        CUSTOMER_ID, 
        SPEND_AMOUNT,
        ROW_NUMBER() OVER (ORDER BY SPEND_AMOUNT DESC) AS UNIQE_NUMBER,
        RANK() OVER (ORDER BY SPEND_AMOUNT DESC) AS SPEND_LEVEL,
        DENSE_RANK () OVER (ORDER BY SPEND_AMOUNT DESC) AS DENSE_RANK
FROM SUPPORTING_DATA.PUBLIC.CUSTOMER_SPEND