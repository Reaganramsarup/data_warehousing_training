SELECT 
        ORDER_ID, 
        CUSTOMER_ID, 
        ORDER_TS, 
        ORDER_AMOUNT,
        LAG(ORDER_AMOUNT) OVER (PARTITION BY CUSTOMER_ID ORDER BY ORDER_TS ASC ) AS LAST_ORDER_AMOUNT,
        (((ORDER_AMOUNT - LAG(ORDER_AMOUNT) OVER (PARTITION BY CUSTOMER_ID ORDER BY ORDER_TS ASC )) / LAG(ORDER_AMOUNT) OVER (PARTITION BY CUSTOMER_ID ORDER BY ORDER_TS ASC )) * 100) AS ORDER_PERC_DIFF
FROM HOL_DB.RAW_POS.ORDER_HEADER
WHERE CUSTOMER_ID IS NOT NULL