CREATE OR REPLACE PROCEDURE DATA_WAREHOUSE.PUBLIC.LOAD_DIM_MENU_TYPE()
RETURNS VARCHAR NOT NULL
LANGUAGE SQL
AS

BEGIN
MERGE INTO DATA_WAREHOUSE.PUBLIC.DIM_MENU_TYPE
USING (
SELECT
MENU_TYPE_ID,
MENU_TYPE_NAME
FROM DATA_WAREHOUSE.PUBLIC.VIRTUAL_DIM_MENU_TYPE
) AS b ON DIM_MENU_TYPE.MENU_TYPE_ID = b.MENU_TYPE_ID
  WHEN MATCHED THEN UPDATE 
  SET 
  MENU_TYPE_NAME = b.MENU_TYPE_NAME
  
  WHEN NOT MATCHED THEN 
  INSERT 
  ( MENU_TYPE_SK,
    MENU_TYPE_ID,
    MENU_TYPE_NAME
  ) 
   VALUES 
   (SEQ_MENU_TYPE_SK.nextval, 
    b.MENU_TYPE_ID,
    b.MENU_TYPE_NAME);

RETURN 'Load is complete';

END;

