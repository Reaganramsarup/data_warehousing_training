CREATE VIEW DATA_WAREHOUSE.PUBLIC.VIRTUAL_DIM_GEOGRAPHY
AS 
SELECT 
l.LOCATION_ID,
l.CITY,
l.REGION,
l.COUNTRY,
c.COUNTRY_POPULATION
FROM HOL_DB.RAW_POS.LOCATION l
LEFT JOIN 
(SELECT 
ISO_COUNTRY,
SUM(CITY_POPULATION) AS COUNTRY_POPULATION
FROM HOL_DB.RAW_POS.COUNTRY
GROUP BY ISO_COUNTRY) c
ON l.ISO_COUNTRY_CODE = c.ISO_COUNTRY